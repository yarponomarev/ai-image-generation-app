# AI Чат-приложение

Вы эксперт в TypeScript, Next.js App Router, React и Tailwind. Следуйте документации Next.js для Data Fetching, Rendering и Routing. Используйте Vercel AI SDK для обработки AI-взаимодействий и потоковых ответов.

Ваша задача - создать AI чат-приложение со следующими конкретными функциями и ключевыми моментами для реализации:

1. Интеграция с Vercel AI SDK:
   - Реализовать Vercel AI SDK для обработки всех AI-операций
   - Использовать встроенные функции SDK для создания чат-завершений и управления состоянием беседы

2. Поддержка моделей OpenAI и Anthropic AI:
   - Интегрировать модели GPT от OpenAI (gpt-4) и Claude 3.5 Sonnet от Anthropic
   - Реализовать специфичные для моделей конфигурации и API-вызовы для каждого провайдера

3. Переключатель выбора модели:
   - Создать удобный переключатель или выпадающее меню в интерфейсе для переключения между моделями OpenAI и Anthropic
   - Обеспечить сохранение выбранной модели между перезагрузками страницы с использованием локального хранилища

4. Интерфейс чата в реальном времени:
   - Разработать адаптивный интерфейс чата с прокручиваемым списком сообщений, отображающим сообщения пользователя и AI
   - Реализовать фиксированное поле ввода в нижней части интерфейса чата
   - Отображать всю историю чата, включая предыдущие беседы, если применимо

5. Потоковые ответы:
   - Использовать возможности потоковой передачи Vercel AI SDK для отображения ответов AI в реальном времени
   - Реализовать индикатор набора текста во время генерации ответа AI

6. Комплексная обработка ошибок и состояния загрузки:
   - Создать информативные сообщения об ошибках для различных сценариев (например, ошибки API, проблемы с сетью)
   - Реализовать индикаторы загрузки или скелетоны для всех асинхронных операций
   - Добавить механизмы повторных попыток для неудачных API-вызовов

7. Обновление API-маршрута:
   - Модифицировать существующий API-маршрут для поддержки моделей OpenAI и Anthropic
   - Реализовать логику маршрутизации запросов к соответствующему AI-провайдеру на основе выбора пользователя
   - Обеспечить правильную обработку ошибок и форматирование ответов для обоих провайдеров

8. Управление историей чата:
   - Реализовать надежную систему для поддержания и корректного отображения истории чата
   - Хранить историю чата в локальном хранилище браузера или базе данных для сохранения между сессиями
   - Предоставить опции для очистки истории чата или начала новой беседы

9. Интеграция Vercel AI SDK для взаимодействий и потоковой передачи:
   - Использовать встроенные хуки SDK (например, useChat, useCompletion) для управления состоянием чата и взаимодействиями
   - Реализовать серверную потоковую передачу с использованием StreamingTextResponse SDK для эффективной обработки ответов

10. Улучшенный пользовательский опыт:
    - Добавить кнопку "Остановить генерацию" для прерывания текущих ответов AI
    - Реализовать рендеринг markdown для ответов AI для поддержки форматированного текста, блоков кода и списков
    - Добавить функцию копирования в буфер обмена для отдельных сообщений

Используйте существующую конфигурацию OpenAI и функции Vercel AI SDK из кодовой базы. Реализуйте функциональность AI-чата в новых компонентах страницы для интерфейса чата. Создайте все необходимые компоненты для пользовательского интерфейса и AI-взаимодействий, включая, но не ограничиваясь:
- Компонент ChatInterface для основного UI чата
- Компонент MessageList для отображения сообщений чата
- Компонент InputField для ввода пользователя
- Компонент ModelSelector для переключения между AI-провайдерами
- Компонент ErrorDisplay для отображения сообщений об ошибках
- Компонент LoadingIndicator для асинхронных операций

Обновите существующий API-маршрут для поддержки моделей OpenAI и Anthropic, обеспечивая правильную обработку ошибок и форматирование ответов для каждого провайдера.

Помните об использовании TypeScript для типовой безопасности, включая правильные определения типов для всех компонентов, функций и API-ответов. Используйте Tailwind CSS для адаптивного и согласованного стилистического оформления приложения. Используйте Next.js App Router для эффективной маршрутизации и получения данных, реализуя серверный рендеринг или статическую генерацию там, где это уместно, для оптимизации производительности. 